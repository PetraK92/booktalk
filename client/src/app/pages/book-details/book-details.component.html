<div class="book-details-wrapper">
  <div class="book-details-container" *ngIf="bookDetails; else loading">
    <div class="book-image">
      <img
        [src]="bookDetails?.imageLinks?.thumbnail || 'assets/no-cover.png'"
        alt="Book image"
      />
    </div>

    <div class="book-info">
      <h2>{{ bookDetails?.title }}</h2>

      <p *ngIf="bookDetails?.authors?.length">
        <strong>Author:</strong> {{ bookDetails?.authors?.join(", ") }}
      </p>

      <p *ngIf="bookDetails?.publisher">
        <strong>Publisher:</strong> {{ bookDetails?.publisher }}
      </p>

      <p *ngIf="bookDetails?.publishedDate">
        <strong>Published:</strong> {{ bookDetails?.publishedDate }}
      </p>

      <p *ngIf="bookDetails?.averageRating">
        <strong>Average Rating:</strong> {{ bookDetails?.averageRating }} / 5
      </p>

      <p *ngIf="bookDetails?.categories?.length">
        <strong>Genres:</strong> {{ bookDetails?.categories?.join(", ") }}
      </p>

      <p *ngIf="bookDetails?.pageCount">
        <strong>Pages:</strong> {{ bookDetails?.pageCount }}
      </p>

      <p *ngIf="bookDetails?.subtitle">
        <strong>Series/Subtitle:</strong> {{ bookDetails?.subtitle }}
      </p>

      <p *ngIf="bookDetails?.description">
        <strong>Description:</strong>
      </p>
      <div
        *ngIf="bookDetails?.description"
        [innerHTML]="bookDetails?.description"
      ></div>
    </div>

    <div class="book-actions">
      <button (click)="addToList('currentlyReading')">Currently Reading</button>
      <button (click)="addToList('tbr')">To be read</button>
      <button (click)="addToList('read')">Read</button>

      <!-- Bekräftelsemeddelande visas här -->
      <div class="confirmation-message" *ngIf="confirmationMessage">
        {{ confirmationMessage }}
      </div>

      <!-- Betygs-komponenten längst ner i kolumnen -->
      <div class="user-rating">
        <strong>Your Rating:</strong>
        <app-star-rating
          [(rating)]="userRating"
          (ratingChange)="onRatingChange($event)"
        ></app-star-rating>
      </div>
      <button [routerLink]="['/profil/review', bookId]">
        {{ hasReview ? "Read/Edit Review" : "Write a Review" }}
      </button>
    </div>
  </div>
</div>

<ng-template #loading>
  <p>Loading book details...</p>
</ng-template>

<p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
